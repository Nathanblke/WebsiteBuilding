<html>
<head>
  <title>Google Charts Example</title>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-analytics.js";
  </script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    // Load the Visualization API and the corechart package
    google.charts.load('current', {'packages':['corechart']});

    // Set a callback to run when the Google Visualization API is loaded
    google.charts.setOnLoadCallback(drawChart);

    // Fetch data from Firebase Realtime Database
    function fetchDataAndDrawChart() {
      var firebaseConfig = {
        // Replace with your Firebase configuration
        apiKey: "AIzaSyDPR_A_lbYBtBZ-FkYdzqFqR97NcSpaTNs",
        authDomain: "gas-array-chart.firebaseapp.com",
        databaseURL: "https://gas-array-chart-default-rtdb.firebaseio.com",
        projectId: "gas-array-chart",
        storageBucket: "gas-array-chart.appspot.com",
        messagingSenderId: "1050254980851",
        appId: "1:1050254980851:web:88b8f7e2d241fdb9d6a986",
        measurementId: "G-C1RWD5JYYB"
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      var dataRef = analytics.ref('/Ppm_H2');
      dataRef.once('value', function(snapshot) {
        var data = snapshot.val();
        drawChart(data);
      });
    }

    // Callback that creates and populates a data table,
    // instantiates the bar chart, passes in the data, and draws it
    function drawChart(data) {
      // Create the data table
      var dataTable = new google.visualization.DataTable();
      dataTable.addColumn('string', 'Label');
      dataTable.addColumn('number', 'Value');

      // Add data to the data table
      for (var label in data) {
        if (data.hasOwnProperty(label)) {
          dataTable.addRow([label, data[label]]);
        }
      }

      // Set chart options
      var options = {
        title: 'Firebase Data Chart',
        height: 400,
        bars: 'vertical',
        hAxis: { title: 'Label' },
        vAxis: { title: 'Value' }
      };

      // Instantiate and draw the chart, passing in the options and data
      var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
      chart.draw(dataTable, options);
    }
  </script>
</head>
<body>
  <h1>Google Charts Example</h1>
  <div id="chart_div"></div>

  <!-- Fetch data and draw the chart -->
  <script>fetchDataAndDrawChart();</script>
</body>
</html>
